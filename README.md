This software modifies Li's psmc to uncover more detailed pouplation history using Beta distribution.

To compile the binaries, you may run

    make;

After that, you may try

    utils/fq2psmcfa -q20 diploid.fq.gz > diploid.psmcfa
    beta-psmc -N25 -t15 -r5 -p 20*1 -B5 -o diploid.psmc diploid.psmcfa

where `diploid.fq.gz' is typically the whole-genome diploid consensus sequence
of one human individual, which can be generated by, for example:

    samtools mpileup -C50 -uf ref.fa aln.bam | bcftools view -c - \
      | vcfutils.pl vcf2fq -d 10 -D 100 | gzip > diploid.fq.gz

Here option -d sets and minimum read depth and -D sets the maximum. It is
recommended to set -d to a third of the average depth and -D to twice.  Program
`fq2psmcfa' transforms the consensus sequence into a fasta-like format where
the i-th character in the output sequence indicates whether there is at least
one heterozygote in the bin [100i, 100i+100).

Program 'beta-psmc' is quite similar to program 'psmc' except for the option '-B'.
The '-B' option specifies the number of sub-atomic time intervals in each atomic time
interval. For the option '-p', it is suggested that each free interval parameter spans
one atomic time interval. The option '-o' specifies the name of output file, which includes
the detailed outputs of beta-psmc similar to psmc. The brief outputs of beta-psmc are in the file out_beta.psmc.

APPENDIX I: Brief Description of the file out_beta.psmc
=======================================================
the "TR" line:  \theta_0 \rho_0
the "MT" line:	maximum 2N_0 coalescent time
the other lines: t_k_start t_k_end \lambda_k \alpha_k \beta_k


APPENDIX II: Scaling the final output
=====================================

The final output is scaled to the 2N_0. There are two ways of rescaling the time
and the popuation size more meaningfully.

Firstly, suppose we know the per-site per-generation mutation rate \mu, we can
compute N_0 as:

  N_0 = \theta_0 / (4\mu) / s

where \theta_0 is given at the 2nd column of "TR" lines, and s is the bin size
we use for generating the psmc-beta input. Knowing N_0, we can scale time to
generations and relative population size to effective size by

  T_k = 2N_0 * t_k
  N_k = N_0 * \lambda_k

where t_k and \lambda_k are given at the 2nd, 3rd and 4th columns of the other lines,
respectively.

A problem with the above strategy is that we do not know a definite answer of
\mu and in fact it various with regions and mutation types. An alternative way
is to use per-site pairwise sequence divergence to represent time:

  d_k = 2\mu * T_k = t_k * \theta_0 / s

and use scaled mutation rate to represent population size:

  \theta_k = 4N_k * \mu = \lambda_k * \theta_0 / s

where, again, t_k and \lambda_k are given at the other lines, \theta_0 at the
"TR" line and s is the bin size, which defaults to 100 in fq2psmcfa.

